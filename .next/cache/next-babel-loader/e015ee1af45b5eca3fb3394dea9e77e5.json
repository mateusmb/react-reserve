{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/magikoopa/Dev/react-reserve/components/Product/AddProductToCart.js\";\nvar __jsx = React.createElement;\nimport React from \"react\";\nimport { Input } from \"semantic-ui-react\";\nimport { useRouter } from \"next/router\";\nimport axios from \"axios\";\nimport baseUrl from \"../../utils/baseUrl\";\nimport catchErrors from \"../../utils/catchErrors\";\nimport cookie from \"js-cookie\";\n\nfunction AddProductToCart(_ref) {\n  var user = _ref.user,\n      productId = _ref.productId;\n\n  var _React$useState = React.useState(1),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      quantity = _React$useState2[0],\n      setQuantity = _React$useState2[1];\n\n  var _React$useState3 = React.useState(false),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      loading = _React$useState4[0],\n      setLoading = _React$useState4[1];\n\n  var _React$useState5 = React.useState(false),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      success = _React$useState6[0],\n      setSuccess = _React$useState6[1];\n\n  var router = useRouter();\n  React.useEffect(function () {\n    var timeout;\n\n    if (success) {\n      timeout = setTimeout(function () {\n        return setSuccess(false);\n      }, 3000);\n    }\n\n    return function () {\n      clearTimeout(timeout);\n    };\n  }, [success]);\n\n  function handleAddProductToCart() {\n    return _handleAddProductToCart.apply(this, arguments);\n  }\n\n  function _handleAddProductToCart() {\n    _handleAddProductToCart = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var url, payload, token, headers;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              setLoading(true);\n              url = \"\".concat(baseUrl, \"/api/cart\");\n              payload = {\n                quantity: quantity,\n                productId: productId\n              };\n              token = cookie.get(\"token\");\n              headers = {\n                headers: {\n                  Authorization: token\n                }\n              };\n              _context.next = 8;\n              return axios.put(url, payload, headers);\n\n            case 8:\n              setSuccess(true);\n              _context.next = 14;\n              break;\n\n            case 11:\n              _context.prev = 11;\n              _context.t0 = _context[\"catch\"](0);\n              catchErrors(_context.t0, window.alert);\n\n            case 14:\n              _context.prev = 14;\n              setLoading(false);\n              return _context.finish(14);\n\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 11, 14, 17]]);\n    }));\n    return _handleAddProductToCart.apply(this, arguments);\n  }\n\n  return __jsx(Input, {\n    type: \"number\",\n    min: \"1\",\n    placeholder: \"Quantity\",\n    value: quantity,\n    onChange: function onChange(event) {\n      return setQuantity(Number(event.target.value));\n    },\n    action: user && success ? {\n      color: \"blue\",\n      content: \"Item Added!\",\n      icon: \"plus cart\",\n      disabled: true\n    } : user ? {\n      color: \"orange\",\n      content: \"Add to Cart\",\n      icon: \"plus cart\",\n      loading: loading,\n      disabled: loading,\n      onClick: handleAddProductToCart\n    } : {\n      color: \"blue\",\n      content: \"Sign Up To Purchase\",\n      icon: \"signup\",\n      onClick: function onClick() {\n        return router.push(\"/signup\");\n      }\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42\n    },\n    __self: this\n  });\n}\n\nexport default AddProductToCart;","map":{"version":3,"sources":["/home/magikoopa/Dev/react-reserve/components/Product/AddProductToCart.js"],"names":["React","Input","useRouter","axios","baseUrl","catchErrors","cookie","AddProductToCart","user","productId","useState","quantity","setQuantity","loading","setLoading","success","setSuccess","router","useEffect","timeout","setTimeout","clearTimeout","handleAddProductToCart","url","payload","token","get","headers","Authorization","put","window","alert","event","Number","target","value","color","content","icon","disabled","onClick","push"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Input } from \"semantic-ui-react\";\nimport { useRouter } from \"next/router\";\nimport axios from \"axios\";\nimport baseUrl from \"../../utils/baseUrl\";\nimport catchErrors from \"../../utils/catchErrors\";\nimport cookie from \"js-cookie\";\n\nfunction AddProductToCart({ user, productId }) {\n  const [quantity, setQuantity] = React.useState(1);\n  const [loading, setLoading] = React.useState(false);\n  const [success, setSuccess] = React.useState(false);\n  const router = useRouter();\n\n  React.useEffect(() => {\n    let timeout;\n    if (success) {\n      timeout = setTimeout(() => setSuccess(false), 3000);\n    }\n    return () => {\n      clearTimeout(timeout);\n    };\n  }, [success]);\n\n  async function handleAddProductToCart() {\n    try {\n      setLoading(true);\n      const url = `${baseUrl}/api/cart`;\n      const payload = { quantity, productId };\n      const token = cookie.get(\"token\");\n      const headers = { headers: { Authorization: token } };\n      await axios.put(url, payload, headers);\n      setSuccess(true);\n    } catch (error) {\n      catchErrors(error, window.alert);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  return (\n    <Input\n      type=\"number\"\n      min=\"1\"\n      placeholder=\"Quantity\"\n      value={quantity}\n      onChange={event => setQuantity(Number(event.target.value))}\n      action={\n        user && success\n          ? {\n              color: \"blue\",\n              content: \"Item Added!\",\n              icon: \"plus cart\",\n              disabled: true\n            }\n          : user\n          ? {\n              color: \"orange\",\n              content: \"Add to Cart\",\n              icon: \"plus cart\",\n              loading,\n              disabled: loading,\n              onClick: handleAddProductToCart\n            }\n          : {\n              color: \"blue\",\n              content: \"Sign Up To Purchase\",\n              icon: \"signup\",\n              onClick: () => router.push(\"/signup\")\n            }\n      }\n    />\n  );\n}\n\nexport default AddProductToCart;\n"]},"metadata":{},"sourceType":"module"}